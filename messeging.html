<!DOCTYPE html>
<html>
  <head>
    <style>
      .message_display {
        border: 2px solid red;
        height: 230px;
        width: 300px;
      }
      .parent {
        display: flex;
        justify-content: space-between;
        padding: 5px;
      }
      .delete {
        color: red;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div>
      <div>
        <div class="message_display" style="overflow: auto"></div>
      </div>

      <form action="#" id="submit">
        <input
          type="text"
          placeholder="Enter a new message"
          class="writeText"
        />
        <button type="submit">Submit</button>
      </form>
    </div>

    <script>
      const form = document.querySelector("#submit");
      const display = document.querySelector(".message_display");
      const input = document.querySelector(".writeText");

      let id = 1;
      let message = [];
      let editId = null;

      form.addEventListener("submit", function (e) {
        e.preventDefault();
        const text = input.value;

        // editing

        if (editId !== null) {
          message = message.map((item) =>
            item.id === editId ? { ...item, text: text } : item
          );
          editId = null;
          input.value = "";
          render();
          return;
        }

        const newMessage = {
          id: id,
          text: text,
        };

        message.push(newMessage);
        id++;
        input.value = "";

        render();
      });

      // DELETE
      display.addEventListener("click", function (e) {
        const parent = e.target.closest(".parent");
        const deleteId = Number(parent.id);

        if (e.target.classList.contains("delete")) {
          message = message.filter((item) => item.id !== deleteId);

          render(); // UI Update
        }

        if (e.target.classList.contains("edit")) {
          const item = message.find((item) => item.id === deleteId);

          input.value = item.text;
          editId = deleteId;
          console.log(editId, "alhamdulillah");

          render();
        }
      });

      // Render function
      function render() {
        display.innerHTML = "";
        message.forEach((item) => {
          const html = `<div class='parent' id=${item.id}>
              <p>${item.text}</p>
              <p class='delete'>DELETE</p>
              <p class='edit'>EDIT</p>
            </div>`;
          display.insertAdjacentHTML("beforeend", html);
        });
      }
    </script>
  </body>
</html>
